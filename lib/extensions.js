(function(){var n=function(o,f){var j=function(a,b,c){try{return a.apply(null,c)}catch(d){console.log("Exception thrown while invoking "+b+":\n"+a);console.log("Arguments: "+c);console.log(d)}},k=function(a,b){b=f.objectFactory(b);j(a.api.onAddExtension,a.name+".onAddExtension",b);return b},l=function(a,b){j(a.api.onRemoveExtension,a.name+".onRemoveExtension",b);return b},g=function(a){this.__registry=a};g.prototype.addExtension=function(){var a=arguments,b=this.api;if(b)a=k(this,a);if(!b||typeof b.allowRemoveAll=== "undefined"||b.allowRemoveAll)this.extensions.push(a);return this};g.prototype.removeExtension=function(a){this.api!==null&&this.api.onRemoveExtension&&l(this,[a]);for(var b=this.extensions,c=0,d=b.length;c<d;c++)if(b[c][0]===a){b.splice(c,1);return}return this};g.prototype.track=function(a){if(typeof a==="function")a={onAddExtension:a};else if(typeof a!=="object"||typeof a.onAddExtension!=="function"){a={name:"ExtensionTrackerError",extensionPoint:this,message:"Object was passed with no onAddExtension funtion. No extensions for "+ this.name+" will be processed"};this.__registry.verbose===true&&console.log(a.message);throw a;}this.api=a;for(var b=this.extensions,c=0,d=b.length;c<d;c++){var e=b[c],h=k(this,e);if(e!==h)b[c]=h}if(typeof a.allowRemoveAll!=="undefined"&&!a.allowRemoveAll)this.extensions=[];return this};g.prototype.disconnect=function(){delete this.__registry.__extensionPoints[this.name]};g.prototype.removeAll=function(){if(this.api!==null&&this.api.onRemoveExtension)for(var a=this.extensions,b=0,c=a.length;b<c;b++)l(this, a[b]);this.extensions=[]};var i=function(){this.__extensionPoints={};this.verbose=true},m=function(a,b){var c=a.__extensionPoints[b];if(!c){c=new g(a);c.name=b;c.extensions=[];c.api=null;a.__extensionPoints[b]=c}return c};i.prototype.registerExtensionPoint=function(a,b){return m(this,a).track(b)};i.prototype.extensionPoint=function(a){return m(this,a)};f.objectFactory=function(a){return a};f.registry=new i;f.tracker={};f.tracker.ExtensionsList=function(a){this.onAddExtension=function(b){a.push(b)}; this.onRemoveExtension=function(b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b){a.splice(c,1);break}};this.allowRemoveAll=false};f.tracker.ExtensionsObject=function(a,b){var c=function(d,e){if(typeof e==="undefined"&&typeof b!=="undefined"){e=d;d=e[b]}return[d,e]};this.onAddExtension=function(d,e){var h=c(d,e);d=h[0];e=h[1];if(typeof d!=="undefined"&&typeof e!=="undefined")a[d]=e};this.onRemoveExtension=function(d){d=c(d)[0];delete a[d]};this.allowRemoveAll=false}};if(typeof modules!=="undefined"&& typeof window!=="undefined"){modules.extensions=n;require("extensions")}else n(require,exports)})();